#!/bin/bash

echo "üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Git Commit Template CLI..."

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ Node.js
if ! command -v node &> /dev/null; then
    echo "‚ùå Node.js –Ω–µ –Ω–∞–π–¥–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Node.js –≤–µ—Ä—Å–∏–∏ 16 –∏–ª–∏ –≤—ã—à–µ."
    echo "–°–∫–∞—á–∞—Ç—å: https://nodejs.org/"
    exit 1
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–µ—Ä—Å–∏—é Node.js
NODE_VERSION=$(node -v | sed 's/v//' | cut -d. -f1)
if [ "$NODE_VERSION" -lt 16 ]; then
    echo "‚ùå –¢—Ä–µ–±—É–µ—Ç—Å—è Node.js –≤–µ—Ä—Å–∏–∏ 16 –∏–ª–∏ –≤—ã—à–µ. –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è: $(node -v)"
    exit 1
fi

echo "‚úÖ Node.js $(node -v) –Ω–∞–π–¥–µ–Ω"

# –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏–ª–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–∑ npm
if [ "$1" = "dev" ]; then
    echo "üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏..."
    npm link
else
    echo "üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ npm..."
    npm install -g git-commit-template-cli
fi

echo "‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"
echo ""
echo "üìù –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:"
echo "  commit-template init    # –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —à–∞–±–ª–æ–Ω –≤ —Ç–µ–∫—É—â–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏"
echo "  ct init                 # –ö–æ—Ä–æ—Ç–∫–∞—è –∫–æ–º–∞–Ω–¥–∞"
echo "  commit-template --help  # –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É"
echo ""
echo "üéâ –ì–æ—Ç–æ–≤–æ! –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ª—é–±–æ–π git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ 'commit-template init'" 